enum ChamadoStatus {
  ABERTO
  EM_ANDAMENTO
  CONCLUIDO
  PAUSADO
}

model Chamado {
  id                Int           @id @default(autoincrement())
  descricao         String?       @db.Text
  assunto           String?       @db.Text
  conclusao         String?       @db.Text
  motivo            String?       // Motivo da pausa ou conclusão
  status            ChamadoStatus @default(ABERTO)
  closedAt          DateTime?     // Data de fechamento do chamado
  tempoChamado      Int?          @default(0) // Tempo total em milissegundos
  ticketsAssociados Json?         // Armazena um array de IDs de tickets relacionados
  comentarios       Json?         // Armazena um array de comentários

  // --- Metadados ---
  createdAt         DateTime      @default(now())
  updatedAt         DateTime      @updatedAt

  // --- Relações e Chaves Estrangeiras ---

  // Relação com Ticket: Um chamado pode ser originado de um Ticket.
  ticket            Ticket?       @relation(fields: [ticketId], references: [id])
  ticketId          Int?

  // Relação com Empresa: Um chamado pertence a uma Empresa.
  empresa           Empresa       @relation(fields: [empresaId], references: [id])
  empresaId         Int

  // Relação com User: Um chamado é atribuído a um User.
  usuario           User          @relation(fields: [userId], references: [id])
  userId            Int

  // Relação com PauseHistory: Um chamado pode ter vários registros de pausa.
  pauseHistory      PauseHistory[]

  // Relação com Media: Um chamado pode ter vários arquivos de mídia anexados.
  media             Media[]

  // Relação Muitos-para-Muitos com Contact (via ChamadoContatos).
  contatos          Contact[]     @relation("ChamadoContatos")

  // --- Mapeamento da Tabela ---
  @@map("Chamados")
}
