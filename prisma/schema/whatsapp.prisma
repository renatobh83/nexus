


model Whatsapp {
  id                 Int      @id @default(autoincrement())
  name               String   @unique
  session            String?  // Opcional, pode não ser aplicável a todos os tipos
  qrcode             String?  // Opcional, usado para pareamento via QR Code
  status             String?  // Ex: 'CONNECTED', 'DISCONNECTED', 'QRCODE'
  battery            String?
  plugged            Boolean?
  isActive           Boolean  @default(true)
  isDeleted          Boolean  @default(false)
  retries            Int?     @default(0)
  isDefault          Boolean  @default(false)
  tokenTelegram      String?
  type               String   @default("whatsapp") // 'whatsapp', 'waba', 'telegram', 'messenger'
  number             String?  // Número de telefone associado à conexão
  wppUser            String?  // ID do usuário no WhatsApp (ex: '5511999998888@c.us')
  pairingCodeEnabled Boolean  @default(false)
  pairingCode        String?
  phone              Json?    // Armazena informações detalhadas do telefone como um objeto JSON
  wabaBSP            String?  // Nome do Business Solution Provider (ex: '360dialog')
  tokenAPI           String?  // Token para a API oficial do WhatsApp
  tokenHook          String?  // Token JWT para autenticar webhooks recebidos
  farewellMessage    String?

  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  // --- Relações ---

  // Relação com Tenant: Uma conexão pertence a um Tenant.
  tenant             Tenant   @relation(fields: [tenantId], references: [id])
  tenantId           Int

  // Relação com ChatFlow: Uma conexão pode ter um ChatFlow padrão.
  // O campo é opcional, então a relação também deve ser.
  chatFlow           ChatFlow? @relation(fields: [chatFlowId], references: [id])
  chatFlowId         Int?

  // Relação com Ticket: Uma conexão pode ter muitos tickets.
  tickets            Ticket[]

  // Mapeia para o nome da tabela existente no banco de dados.
  @@map("Whatsapp")
}